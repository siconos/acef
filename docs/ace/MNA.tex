\documentclass[10pt]{article}
\input{macro.tex}
\usepackage{psfrag}
\usepackage{fancyhdr}
\usepackage{subfigure}
%\renewcommand{\baselinestretch}{1.2}
\textheight 23cm
\textwidth 16cm
\topmargin 0cm
%\evensidemargin 0cm
\oddsidemargin 0cm
\evensidemargin 0cm
\usepackage{layout}
\usepackage{mathpple}
\makeatletter
\renewcommand\bibsection{\paragraph{References
     \@mkboth{\MakeUppercase{\bibname}}{\MakeUppercase{\bibname}}}}
\makeatother
%% style des entetes et des pieds de page
\fancyhf{} % nettoie le entetes et les pieds
\fancyhead[L]{Template 6 : Electrical oscillator with 4 diodes bridge full-wave rectifier - Pascal Denoyelle}
%\fancyhead[C]{}%
\fancyhead[R]{\thepage}
%\fancyfoot[L]{\resizebox{!}{0.7cm}{\includegraphics[clip]{logoesm2.eps}}}%
\fancyfoot[C]{}%
 \begin{document}
 
\section{Introduction\\}
This document is a short overview about the Modified Nodal Analysis. The M.N.A. is the method used
in SPICE to obtain the circuit equation formulation. For more details, read the book <<Circuit Simulation
Methods and Algorithms by Jan Ogrodzki>>.

\subsection{Notations}
\begin{enumerate}
  \item U is a tension, I is a current.
  \item V denotes a node's potential.
  \item q denotes a capacitor's charge.
  \item $\psi$ denotes a inductor's flux.
  \item Indice $_{a}$ denotes the current branch.
  \item Indice $_{b}$ denotes the other branch whose voltage is a controlling variable.
  \item Indice $_{c}$ denotes the other branch whose current is a controlling variable.
  \end{enumerate}

\newtheorem{mur}{Def}
\begin{mur}
The branch is current-defined if its currents is a function of its own voltage, controlling variable
or their derivatives:
\begin{equation}\label{CD}I_{a}=F_{i}(U_{a},U_{b},I_{c},\frac{dU_a}{dt},\frac{dU_b}{dt},\frac{dI_{c}}{dt})\end{equation}
\end{mur}
Examples : \\
A resistor is a current-defined branch because $I_{a}=\frac{U_{a}}{R}$.\\
A capacitor is a current-defined branch because $I_{a}=C\frac{dU_{a}}{dt}$.\\
\begin{mur}
The branch is voltage-defined if its voltage is a function of its own current, controlling variable
or their derivatives:
\begin{equation}\label{VD}U_{a}=F_{i}(I_{a},U_{b},I_{c},\frac{dU_a}{dt},\frac{dU_b}{dt},\frac{dI_{c}}{dt})\end{equation}
\end{mur}
Examples : \\
A resistor is a voltage-defined branch because $U_{a}=RI_{a}$.\\
A inductor is a voltage-defined branch because $U_{a}=L\frac{dI_{a}}{dt}$.\\
\section{Hypothesis\\}
The M.N.A. assumes smooth branches are explicit functions of current or voltage. It means each smooth
branch is Voltage Defined (V.D.) or Current Defined (C.D.)\\
\section{Unknowns}
The M.N.A. use the following unknowns:
\begin{enumerate}
\item Nodal voltages\\
\item Currents in the V.D. branches\\
\item Capacitor's charges and currents
\item Inductor's flux and currents
\item Currents control
\end{enumerate}
These unknowns are sufficient to describe the circuit.
\section{Equations}
The M.N.A. use following equations:
\subsection{The Kirchhoff Current Law (KCL)}
\newtheorem{kcl}{Kcl}
\begin{kcl}
At any node in an electrical circuit where charge density is not changing in time, the sum of
currents flowing towards that node is equal to the sum of currents flowing away from that node.
\end{kcl}
KCL law gives this type of equation:\\
$I_{1}+I_{2}+...+I_{n}=0$\\
Current from current-defined branch is replaced with relation \ref{CD}. The result is a linear relation between system's unknowns.
\subsection{Law in voltage-defined branches (LVD)}
It consists in replacing $U_{a}$ with $V_{i}-V_{j}$ in the relation \ref{VD} and we obtain a linear relation between system's unknowns.
\[V_{i}-V_{j}=F_{i}(I_{a},U_{b},I_{c},\frac{dU_a}{dt},\frac{dU_b}{dt},\frac{dI_{c}}{dt})\]
\subsection{Capacitor laws (CAP)}
A relation between capacitor charge and tension (CAP1):\\
\[ q_{a}=CU_{a} \]
Voltage definition (CAP2):
\[ U_{a}=V_{i}-V_{j} \]
A dynamic relation (CAP3):
\[ I_{a}=\frac{dq_{a}}{dt} \]

After a time discretisation, these equations give tow linear relations between system's unknowns.
\subsection{Inductor laws (IND)}
A relation between inductor flux and current (IND1):\\
\[ \psi _{a}=LI_{a} \]
A dynamic relation (IND2):
\[ V_{i}-V_{j}=\frac{d\psi _{a}}{dt} \]
After a time discretisation, these equations give tow linear relations between system's unknowns.

\section{Example}
\begin{figure}[h]
\centerline{
 \scalebox{0.5}{
    \input{MNA.pstex_t}
 }
}
\end{figure}

\subsection{Unknowns}
\begin{enumerate}
\item Branch 1 is voltage defined.
\item Branch 2 is looked as current defined ($I_{2}=\frac{U_{2}}{R}$).
\item Branch 3 is current defined.
\item Branch 4 is voltage defined.
\item Branch 5 is looked as current defined ($U_{5}=RIU_{5}$).
\end{enumerate}
Therefore the unknowns vector is:\\
(V1,V2,V3,I1,I3,I4,I5,U3,q3,$\psi 4$)
\subsection{Table Equation}
\[\left(\begin{array}{cccccccccccc}
  &V1&V2&V3&I1&I3&I4&I5&U3&q3&\psi 4\\
  \hline
  \left(\begin{array}{c} KCL1 \end{array}\right)&\frac{-1}{R_{2}}&\frac{1}{R_{2}}&0&-1&0&0&0&0&0\\
  \left(\begin{array}{c} KCL2 \end{array}\right)&\frac{1}{R_{2}}&\frac{-1}{R_{2}}&0&0&-1&0&0&0&0&0\\
  \left(\begin{array}{c} KCL3 \end{array}\right)&0&0&0&0&0&1&-1&0&0&0\\
  \left(\begin{array}{c} CAP1 \end{array}\right)&0&0&0&0&0&0&0&C_{3}&-1&0\\
  \left(\begin{array}{c} IND1 \end{array}\right)&0&0&0&0&0&L_{4}&0&0&0&-1\\
  \left(\begin{array}{c} VDL5 \end{array}\right)&0&0&\frac{-1}{R_{5}}&0&0&0&1&0&0&0\\
  \left(\begin{array}{c} VDL1 \end{array}\right)&1&0&0&0&0&0&0&0&0&0&0\\
  \left(\begin{array}{c} CAP2 \end{array}\right)&0&1&0&0&0&0&0&-1&0&0&0\\
  \left(\begin{array}{c} CAP3 \end{array}\right)&0&0&0&0&1&0&0&0&0&\frac{-1}{h}&0\\
  \left(\begin{array}{c} IND2 \end{array}\right)&0&1&0&0&0&0&0&0&0&0&\frac{-1}{h}\\
\end{array}\right) =
\left(\begin{array}{c}
  RSH\\
  \hline
  0\\
  0\\
  0\\
  0\\
  0\\
  0\\
  0\\
  U_{1}(t)\\
  0\\
  \frac{-q_{3}(t-h)}{h}\\
  \frac{-\psi_{4}(t-h)}{h}\\
\end{array}\right)\]



\section{Stamp method}
The stamp method is an algorithmic method used to fill the table equation from the components. It
consists in writing a sub-table for each type of component, this sub-table is the contribution of the component in the tableau equation.\\
Following, this is stamp examples.
\subsection{Resistor stamp}
\[\left(\begin{array}{cccc}
&V_{i}&V_{j}&RSH\\
  \hline
  KCL(i)&\frac{-1}{R}&\frac{1}{R}&\\
  KCL(j)&\frac{1}{R}&\frac{-1}{R}&\\
  \end{array}\right)
\]
Where R is the branch's resistance.
\subsection{Conductance stamp}
\[\left(\begin{array}{ccccc}
&V_{i}&V_{j}&I_{a}&RSH\\
  \hline
  KCL(i)&&&1&\\
  KCL(j)&&&-1&\\
  LVD&G&-G&1&\\
  \end{array}\right)
\]
Where G is the branch's conductance.
\subsection{Voltage source stamp}
\[\left(\begin{array}{ccccc}
&V_{i}&V_{j}&I_{a}&RSH\\
  \hline
  KCL(i)&&&1\\
  KCL(j)&&&-1\\
  LVD&1&-1&&E
  \end{array}\right)
\]
\subsection{Current controlled voltage source stamp}
\[\left(\begin{array}{cccccc}
&V_{i}&V_{j}&I_{a}&I_{b}&RSH\\
  \hline
  KCL(i)&&&1&\\
  KCL(j)&&&-1&\\
  LVD&1&-1&&\gamma
  \end{array}\right)
\]
With $U_{a} = \gamma I_{b}$.

 \end{document}
